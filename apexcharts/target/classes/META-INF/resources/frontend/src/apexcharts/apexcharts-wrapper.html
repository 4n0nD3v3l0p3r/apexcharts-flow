<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/custom-style.html">
<link rel="import" href="../../bower_components/vaadin-themable-mixin/vaadin-themable-mixin.html">

<script src="../../../../webjars/apexcharts/3.6.8/dist/apexcharts.js"></script>
<dom-module id="apex-charts-wrapper">
    <template>
        <style>
            ::slotted(div) {
                overflow: hidden;
            }
        </style>
        <slot></slot>
    </template>
    <script>
        class ApexChartsWrapper extends Vaadin.ThemableMixin(Polymer.Element){
            static get is(){
                return 'apex-charts-wrapper'
            }

            static get properties(){
                return {
                    annotations: {
                        type: Object
                    }, // ApexAnnotations;
                    chart: {
                        type: Object
                    }, // ApexChart;
                    colors: {
                        type: Object
                    }, // string[];
                    dataLabels: {
                        type: Object
                    }, // ApexDataLabels;
                    fill: {
                        type: Object
                    }, // ApexFill;
                    grid: {
                        type: Object
                    }, // ApexGrid;
                    labels: {
                        type: Object
                    }, // string[];
                    legend: {
                        type: Object
                    }, // ApexLegend;
                    markers: {
                        type: Object
                    }, // ApexMarkers;
                    noData: {
                        type: Object
                    }, // ApexNoData;
                    plotOptions: {
                        type: Object
                    }, // ApexPlotOptions;
                    responsive: {
                        type: Object
                    }, // ApexResponsive[];
                    series: {
                        type: Object
                    }, // ApexAxisChartSeries | ApexNonAxisChartSeries;
                    states: {
                        type: Object
                    }, // ApexStates;
                    stroke: {
                        type: Object
                    }, // ApexStroke;
                    subtitle: {
                        type: Object
                    }, // ApexTitleSubtitle;
                    theme: {
                        type: Object
                    }, // ApexTheme;
                    chartTitle: {
                        type: Object
                    }, // ApexTitleSubtitle;
                    tooltip: {
                        type: Object
                    }, // ApexTooltip;
                    xaxis: {
                        type: Object
                    }, // ApexXAxis;
                    yaxis: {
                        type: Object
                    }, // ApexYAxis | ApexYAxis[];
                    width: {
                        type: String
                    },
                    height: {
                        type: String
                    }
                }
            }

            ready(){
                super.ready();
                var config = {};
                if (this.annotations) {
                    config.annotations = this.annotations;
                }
                if (this.chart) {
                    config.chart = JSON.parse(this.chart);
                }
                if (this.series) {
                    config.series = JSON.parse(this.series);
                }
                if (this.labels) {
                    config.labels = this.labels;
                }
                if (this.colors) {
                    config.colors = JSON.parse(this.colors);
                }
                if (this.dataLabels) {
                    config.dataLabels = JSON.parse(this.dataLabels);
                }
                if (this.fill) {
                    config.fill = JSON.parse(this.fill);
                }
                if (this.grid) {
                    config.grid = JSON.parse(this.grid);
                }
                if (this.legend) {
                    config.legend = JSON.parse(this.legend);
                }
                if (this.markers) {
                    config.markers = this.markers;
                }
                if (this.noData) {
                    config.noData = this.noData;
                }
                if (this.plotOptions) {
                    config.plotOptions = JSON.parse(this.plotOptions);
                }
                if (this.responsive) {
                    config.responsive = JSON.parse(this.responsive);
                }
                if (this.states) {
                    config.states = this.states;
                }
                if (this.stroke) {
                    config.stroke = JSON.parse(this.stroke);
                }
                if (this.subtitle) {
                    config.subtitle = JSON.parse(this.subtitle);
                }
                if (this.theme) {
                    config.theme = this.theme;
                }
                if (this.chartTitle) {
                    config.title = JSON.parse(this.chartTitle);
                }
                if (this.tooltip) {
                    config.tooltip = JSON.parse(this.tooltip);
                }
                if (this.xaxis) {
                    config.xaxis = JSON.parse(this.xaxis);
                }
                if (this.yaxis) {
                    config.yaxis = JSON.parse(this.yaxis);
                }
                if (this.width) {
                    if (!config.chart) {
                        config.chart = {};
                    }
                    config.chart.width = this.width;
                }
                if (this.height) {
                    if (!config.chart) {
                        config.chart = {};
                    }
                    config.chart.height = this.height;
                }
                console.log(config);
                var div = document.createElement('div');
                this.appendChild(div);
                var chart = new ApexCharts(div, config);
                chart.render();
            }
        }
        customElements.define(ApexChartsWrapper.is, ApexChartsWrapper);
    </script>
</dom-module>
